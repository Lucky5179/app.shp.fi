var u=Object.defineProperty;var h=(r,t,e)=>t in r?u(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var n=(r,t,e)=>(h(r,typeof t!="symbol"?t+"":t,e),e);import{a as c}from"./index-94364f2e.js";import{h4 as a,h5 as g,d3 as d}from"./index-e33bfe5b.js";const p={}.VITE_API_URL||"https://api.goat.fi",w={}.VITE_API_ZAP_URL||`${p}/zap`;function y(r){return"compoundingsPerYear"in r}function _(r){return"vaultApr"in r&&!("compoundingsPerYear"in r)}function A(r){return"totalApy"in r&&!("compoundingsPerYear"in r)}class B{constructor(){n(this,"api");this.api=c.create({baseURL:p,timeout:30*1e3})}async getPrices(){if(a("prices"))throw new Error("Simulated beefy api error");return(await this.api.get("/prices",{params:{_:this.getCacheBuster("short")}})).data}async getLPs(){if(a("lps"))throw new Error("Simulated beefy api error");return(await this.api.get("/lps",{params:{_:this.getCacheBuster("short")}})).data}async getLpsBreakdown(){if(a("lpsBreakdown"))throw new Error("Simulated beefy api error");return(await this.api.get("/lps/breakdown",{params:{_:this.getCacheBuster("short")}})).data}async getApyBreakdown(){if(a("apy"))throw new Error("Simulated beefy api error");const t=await this.api.get("/apy/breakdown",{params:{_:this.getCacheBuster("short")}});return g(t.data,(s,i)=>(i==="vaultApr"&&d(s)&&(s=parseFloat(s)),s))}async getVaultLastHarvest(){const t=await this.api.get("/vaults/last-harvest",{params:{_:this.getCacheBuster("short")}}),s=(await this.api.get("/multistrategies")).data.reduce((i,o)=>(i[o.address]=o.lastReport,i),{});return{...t.data,...s}}async getFees(){if(a("fees"))throw new Error("Simulated beefy api error");return(await this.api.get("/fees",{params:{_:this.getCacheBuster("short")}})).data}async getZapAggregatorTokenSupport(){if(a("zap-support"))throw new Error("Simulated beefy api error");const e=(await this.api.get(`${w}/swaps`,{params:{_:this.getCacheBuster("short")}})).data;return"one"in e&&(e.harmony=e.one,delete e.one),e}async getTreasury(){if(a("treasury"))throw new Error("Simulated beefy api error");return(await this.api.get("/treasury",{params:{_:this.getCacheBuster("short")}})).data}async getActiveProposals(){if(a("snapshot"))throw new Error("Simulated beefy api error");return(await this.api.get("/snapshot/active",{params:{_:this.getCacheBuster("short")}})).data}getCacheBuster(t="short"){const e=new Date;return t==="long"?e.setMinutes(0,0,0):e.setSeconds(0,0),e.getTime()}}export{p as API_URL,w as API_ZAP_URL,B as BeefyAPI,_ as isGovVaultApy,A as isMaxiVaultApy,y as isStandardVaultApy};
